<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adjusting HIV prevalence from ANC-RT data for common biases • ANCRTAdjust</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Adjusting HIV prevalence from ANC-RT data for common biases">
<meta property="og:description" content="This package provides a series of tools to: 1) Prepare country-specific ANC HIV routine 
	testing data for analysis.  The data is cleaned according to common inconsistencies found in this 
	type of data. 2) Adjust HIV prevalence estimates for biases due to missing data and invalid data.   ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ANCRTAdjust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brittanyblouin/ANCRTAdjust">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="ancrtadjust" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#ancrtadjust" class="anchor"></a>ANCRTAdjust</h1></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In HIV-endemic countries, antenatal care sentinel surveillance (ANC-SS) has historically been used to monitor epidemiological trends in HIV prevalence over time. Recently, several countries are transitioning from ANC-SS to the use of ANC routine testing (ANC-RT) data. Despite important advantages of using ANC-RT over conducting sentinel surveillance, the use of routinely collected program data raises concerns regarding data completeness and consistency. It is imperative that a clear and simple procedure be established for the use of such data so that valid conclusions can be drawn.</p>
<p><code>ANCRTAdjust</code> is an R package that was developed to check and validate ANC-RT data. The specific functions have been designed to allow program managers using ANC-RT data to monitor HIV trends in endemic countries to use a standard protocol to:</p>
<ol>
<li>Evaluate data quality and completeness;<br>
</li>
<li>Perform data cleaning;<br>
</li>
<li>Identify outlying observations; and,<br>
</li>
<li>Perform adjustments for common data inconsistencies due to incomplete reporting periods, multiple testing, and/or imperfect testing coverage.</li>
</ol>
<p>A standard protocol for data validation, implemented across all countries providing ANC-RT data for monitoring HIV trends, will ensure that HIV prevalence estimates are consistent, reproducible and valid. After installation, we propose an 8-step approach to achieve this using functions implemented in the <code>ANCRTAdjust</code> package.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install via Github using <code>devtools</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># if devtools is not already installed, copy-paste the following: install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"brittanyblouin/ANCRTAdjust"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ANCRTAdjust)</code></pre></div>
<p>Once installed, we will load a simulated ANC-RT dataset and walk through the different steps required to clean and adjust ANC-RT data.</p>
</div>
<div id="step-1-loading-the-anc-rt-data" class="section level2">
<h2 class="hasAnchor">
<a href="#step-1-loading-the-anc-rt-data" class="anchor"></a>Step 1) Loading the ANC-RT data</h2>
<p>For illustration purposes, we first load the supplied simulated ANC-RT dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(ancrt)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ancrt)
  faciluid time n_clients n_status knownpos testpos testneg  true_prv snu1 year
<span class="dv">1</span>      F_<span class="dv">1</span>    <span class="dv">1</span>       <span class="dv">217</span>      <span class="dv">217</span>       <span class="dv">29</span>      <span class="dv">37</span>     <span class="dv">151</span> <span class="fl">0.3041475</span>    <span class="dv">1</span> <span class="dv">2015</span>
<span class="dv">2</span>      F_<span class="dv">1</span>    <span class="dv">2</span>       <span class="dv">240</span>      <span class="dv">240</span>       <span class="dv">31</span>      <span class="dv">40</span>     <span class="dv">169</span> <span class="fl">0.2958333</span>    <span class="dv">1</span> <span class="dv">2015</span>
<span class="dv">3</span>      F_<span class="dv">1</span>    <span class="dv">3</span>       <span class="dv">216</span>      <span class="dv">216</span>       <span class="dv">30</span>      <span class="dv">38</span>     <span class="dv">148</span> <span class="fl">0.3148148</span>    <span class="dv">1</span> <span class="dv">2015</span>
<span class="dv">4</span>      F_<span class="dv">1</span>    <span class="dv">4</span>       <span class="dv">159</span>      <span class="dv">159</span>       <span class="dv">22</span>      <span class="dv">28</span>     <span class="dv">109</span> <span class="fl">0.3144654</span>    <span class="dv">1</span> <span class="dv">2015</span>
<span class="dv">5</span>      F_<span class="dv">1</span>    <span class="dv">5</span>       <span class="dv">192</span>      <span class="dv">192</span>       <span class="dv">25</span>      <span class="dv">32</span>     <span class="dv">135</span> <span class="fl">0.2968750</span>    <span class="dv">1</span> <span class="dv">2015</span>
<span class="dv">6</span>      F_<span class="dv">1</span>    <span class="dv">6</span>       <span class="dv">214</span>      <span class="dv">214</span>       <span class="dv">30</span>      <span class="dv">39</span>     <span class="dv">145</span> <span class="fl">0.3224299</span>    <span class="dv">1</span> <span class="dv">2016</span></code></pre></div>
</div>
<div id="step-2-verifying-your-database-and-naming-your-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#step-2-verifying-your-database-and-naming-your-variables" class="anchor"></a>Step 2) Verifying your database and naming your variables</h2>
<p>After loading the data, the next step is to make sure we are following the naming conventions for the most important variables. These include:</p>
<ul>
<li>
<code>faciluid</code>: the unique facility identifier.<br>
</li>
<li>
<code>time</code>: the calendar time over which the data was collected.<br>
</li>
<li>
<code>n_clients</code>: the number of women from the specified facility, during the specified time period, that attended their first ANC visit.<br>
</li>
<li>
<code>n_status</code>: the number of women from the specified facility, during the specified time period, that had their HIV status ascertained at their first ANC visit, either by testing or through previous knowledge of their status (if available). Note: If data is not available for <code>n_status</code> it will automatically be created with missing data for all observations.</li>
<li>
<code>knownpos</code>: the number of women from the specified facility, during the specified time period, that already knew that they were HIV-positive at their first ANC visit (if available). Note: If data is not available for <code>knownpos</code> it will automatically be created with missing data for all observations.</li>
<li>
<code>testpos</code>: the number of women from the specified facility, during the specified time period, that tested positive for HIV at their first ANC visit (if available). Note: If data is not available for <code>testpos</code> it will automatically be created with missing data for all observations.</li>
<li>
<code>testneg</code>: the number of women from the specified facility, during the specified time period, that tested negative for HIV at their first ANC visit (if available). Note: If data is not available for <code>testneg</code> it will automatically be created with missing data for all observations.</li>
<li>
<code>totpos</code>: the number of women from the specified facility, during the specified time period, that were HIV-positive at their first ANC visit (if available). Note: If data is not available for <code>totpos</code> it will automatically be created as the sum of <code>testpos</code> and <code>knownpos</code>.</li>
</ul>
<p>Some data might be available age-disaggregated. If so, the variable should be named:</p>
<ul>
<li>
<code>age</code>: age category of pregnant women.</li>
</ul>
<p>Finally, data might be available for the sub-national unit 1 and for the year (allowing some results to be stratified by these variables). If so, these variables should be named:</p>
<ul>
<li>
<code>snu1</code>: The sub-national unit 1.</li>
<li>
<code>year</code>: The calendar year that the data was collected.</li>
</ul>
<p>The function <code><a href="reference/check_data.html">check_data()</a></code> can automatically verify if you have the correct data structure and rename (if warranted) the variables for you (see <code><a href="https://rdrr.io/r/utils/help.html">help(check_data)</a></code> for more information).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>ancrt &lt;-<span class="st"> </span><span class="kw"><a href="reference/check_data.html">check_data</a></span>(ancrt, <span class="dt">faciluid =</span> <span class="st">"faciluid"</span>, <span class="dt">time =</span> <span class="st">"time"</span>, <span class="dt">n_clients =</span> <span class="st">'n_clients'</span>, <span class="dt">n_status =</span> <span class="st">"n_status"</span>, <span class="dt">knownpos =</span> <span class="st">"knownpos"</span>, <span class="dt">testpos =</span> <span class="st">"testpos"</span>, <span class="dt">testneg =</span> <span class="st">"testneg"</span>, <span class="dt">snu1 =</span> <span class="st">"snu1"</span>, <span class="dt">year =</span> <span class="st">"year"</span>)</code></pre></div>
</div>
<div id="step-3-data-cleaning" class="section level2">
<h2 class="hasAnchor">
<a href="#step-3-data-cleaning" class="anchor"></a>Step 3) Data cleaning</h2>
<p>The third step is to clean the data using the <code><a href="reference/data_clean.html">data_clean()</a></code> function. Full details on the data cleaning procedure implemented in this function can be found by typing <code><a href="https://rdrr.io/r/utils/help.html">help(data_clean)</a></code> in your console. Briefly, the data is cleaned in the following ways:</p>
<ul>
<li>If any one of <code>n_status</code>, <code>testneg</code>, <code>testpos</code>, <code>knownpos</code>, or <code>totpos</code> is missing for a particular observation, we can calculate it from the other variables (i.e., they are perfectly correlated).</li>
<li>In cases where <code>n_status</code> &gt; <code>n_clients</code> due to multiple testing, we can implement three adjustments: a) impute using the mean facility coverage, b) remove those observations, c) set testing coverage to 100%. In this case, the total number of women found to be living with HIV is also adjusted.</li>
<li>If the total number of HIV-positive women (<code>totpos</code>) is higher than the number of women tested (<code>n_status</code>), we reclassify that observation as missing (<code>NA</code>).</li>
<li>Finally, the data is checked for duplicates (i.e., more than one observation exists with the same <code>faciluid</code> and <code>time</code>).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ancrt_cleaned &lt;-<span class="st"> </span><span class="kw"><a href="reference/data_clean.html">data_clean</a></span>(ancrt)</code></pre></div>
</div>
<div id="step-4-descriptive-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#step-4-descriptive-graphs" class="anchor"></a>Step 4) Descriptive graphs</h2>
<p>An inuitive way to examine the impact of data cleaning and adjustment options is to plot the results. This is achieved using the <code><a href="reference/descriptive_plot.html">descriptive_plot()</a></code> function.</p>
<p>For example, the first plot below shows the overal proportion of facilities at each time point that exhibit two main types of data quality problems: a) the percent of observations with missing data for <code>n_clients</code>, <code>n_status_c</code> or <code>totpos_c</code> (in the cleaned data) and b) the percent of observations with invalid values for <code>n_clients</code>, <code>n_status</code>, <code>testpos</code> or <code>knownpos</code> (in the raw data).</p>
<p>The second graph shows how HIV testing coverage is affected by different possible types of adjusment for invalid testing coverage. Specifically, HIV testing coverage calculated from a) the raw data, b) the cleaned data, and using the three adjustment options for multiple testing: c) imputing invalid testing coverage value by the mean of the valid facility coverage estimates (impute option), d) removing invalid values (remove option), and e) replacing all HIV testing coverage higher than 100% by this value (set to maximum option).</p>
<p>Finally, the third plot shows temporal trends in HIV prevalence from ANC-RT data using the same options as for the second graph. In our simulated example here, we can see that all options provide similar estimates of HIV prevalence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/descriptive_plot.html">descriptive_plot</a></span>(ancrt_cleaned)</code></pre></div>
<p><img src="reference/figures/README-example-1.png" alt="Fig 1. Descriptive plots of the impact of data cleaning and adjustment options on the simulated ANC-RT dataset."></p>
</div>
<div id="optional-data-quality-indicators" class="section level2">
<h2 class="hasAnchor">
<a href="#optional-data-quality-indicators" class="anchor"></a>Optional: Data quality indicators</h2>
<p>It is important to assess the quality of the data. Specifically, missing data and impossible values can have important effects on the validity of the results. The function <code><a href="reference/quality_indicators.html">quality_indicators()</a></code> will automatically calculate the following data quality indicators from the raw and cleaned data and output the results in a table:</p>
<ul>
<li>The number and % of facilities that don’t report all quarters.</li>
<li>The number and % of observations with missing data for each of: <code>n_clients</code>, <code>n_status</code>, <code>testpos</code>, <code>testneg</code> and <code>knownpos</code>.</li>
<li>The number and % of observations with missing data for at least one of <code>n_clients</code>, <code>n_status</code>, or <code>totpos</code>.</li>
<li>The number and % of observations with <code>n_status</code> &gt; <code>n_clients</code> (HIV testing coverage &gt; 100%).</li>
<li>The number and % of observations with <code>n_status</code> &lt; <code>totpos</code> (HIV prevalence &gt; 100%).</li>
<li>The number and % of observations with <code>n_status</code> &lt; (<code>testpos</code> + <code>testneg</code> + <code>knownpos</code>).</li>
<li>The number and % of observations with negative values for each of: <code>n_clients</code>, <code>n_status</code>, <code>testpos</code>, <code>testneg</code> and <code>knownpos</code>.</li>
<li>The number and % of observations with invalid data for at least one of <code>n_clients</code>, <code>n_status</code>, <code>testpos</code>, or <code>knownpos</code>.</li>
</ul>
<p>The data quality indicators can be calculated for the entire country dataset or stratified by region and/or time period (see <code><a href="https://rdrr.io/r/utils/help.html">help(quality_indicators)</a></code> for more information).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ancrt_quality &lt;-<span class="st"> </span><span class="kw"><a href="reference/quality_indicators.html">quality_indicators</a></span>(ancrt_cleaned, <span class="dt">by_region =</span> <span class="ot">FALSE</span>, <span class="dt">by_time =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>ancrt_quality
                              Raw.Count Raw.Percent Clean.Count Clean.Percent
Missing <span class="op">&gt;=</span><span class="dv">1</span> quarter                   <span class="dv">0</span>        (<span class="dv">0</span>%)          <span class="ot">NA</span>            <span class="ot">NA</span>
Missing n_clients                     <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Missing n_status                      <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Missing testpos                       <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Missing testneg                       <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Missing knownpos                      <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Missing <span class="op">&gt;=</span><span class="dv">1</span> variables                 <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Invalid coverage                    <span class="dv">654</span>     (<span class="fl">3.27</span><span class="op">%)         650       (3.25%</span>)
Invalid prevalence                    <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Inconsistent n_status               <span class="dv">475</span>     (<span class="fl">2.38</span><span class="op">%)           0          (0%</span>)
Negative n_clients                    <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Negative n_status                     <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Negative testpos                      <span class="dv">1</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Negative testneg                      <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
Negative knownpos                     <span class="dv">0</span>        (<span class="dv">0</span><span class="op">%)           0          (0%</span>)
One or more invalid variables       <span class="dv">886</span>     (<span class="fl">4.43</span><span class="op">%)         650       (3.25%</span>)</code></pre></div>
</div>
<div id="step-5-flagging-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#step-5-flagging-outliers" class="anchor"></a>Step 5) Flagging outliers</h2>
<p>It is possible that errors exist in the data and these may be detected by investigating outlier observations. The function <code><a href="reference/flag_outliers.html">flag_outliers()</a></code> will flag outliers for the variables <code>n_clients</code>, <code>n_status_c</code>, <code>testpos_c</code>, <code>testneg_c</code>, <code>knownpos_c</code>, <code>totpos_c</code>, <code>prv</code> and <code>cov</code>. Outliers are defined as being more than two standard deviations greater than or less than the mean value. The mean reference to which observations are compared can either be the facility-specific mean, the subnational unit 1-specific mean or the country-specific mean, according to user inputs. The flagged data can either be output as the full dataset with additional variables indicating outlier observations, or a dataset that only includes data for outlier observations. See <code><a href="https://rdrr.io/r/utils/help.html">help(flag_outliers)</a></code> for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">outliers &lt;-<span class="st"> </span><span class="kw"><a href="reference/flag_outliers.html">flag_outliers</a></span>(ancrt_cleaned, <span class="dt">flag_by =</span> <span class="st">"facility"</span>, <span class="dt">result =</span> <span class="st">"outliers"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(outliers)
faciluid time n_clients n_status_c testpos_c testneg_c knownpos_c totpos_c       prv       cov
<span class="dv">1</span>      F_<span class="dv">1</span>    <span class="dv">4</span>       <span class="dv">159</span>        <span class="dv">159</span>        <span class="ot">NA</span>       <span class="dv">109</span>         <span class="ot">NA</span>       <span class="ot">NA</span>        <span class="ot">NA</span>        <span class="ot">NA</span>
<span class="dv">2</span>      F_<span class="dv">1</span>    <span class="dv">7</span>        <span class="ot">NA</span>         <span class="ot">NA</span>        <span class="ot">NA</span>        <span class="ot">NA</span>         <span class="dv">37</span>       <span class="ot">NA</span>        <span class="ot">NA</span>        <span class="ot">NA</span>
<span class="dv">3</span>      F_<span class="dv">1</span>   <span class="dv">13</span>        <span class="ot">NA</span>         <span class="ot">NA</span>        <span class="ot">NA</span>        <span class="ot">NA</span>         <span class="ot">NA</span>       <span class="ot">NA</span>        <span class="ot">NA</span> <span class="fl">0.9956140</span>
<span class="dv">4</span>      F_<span class="dv">1</span>   <span class="dv">14</span>        <span class="ot">NA</span>         <span class="ot">NA</span>        <span class="ot">NA</span>        <span class="ot">NA</span>         <span class="ot">NA</span>       <span class="ot">NA</span>        <span class="ot">NA</span> <span class="fl">0.9954128</span>
<span class="dv">5</span>      F_<span class="dv">1</span>   <span class="dv">18</span>        <span class="ot">NA</span>         <span class="ot">NA</span>        <span class="ot">NA</span>       <span class="dv">104</span>         <span class="ot">NA</span>       <span class="ot">NA</span> <span class="fl">0.3918129</span>        <span class="ot">NA</span>
<span class="dv">6</span>     F_<span class="dv">10</span>   <span class="dv">17</span>        <span class="ot">NA</span>        <span class="dv">243</span>         <span class="dv">8</span>        <span class="ot">NA</span>          <span class="dv">6</span>       <span class="dv">14</span>        <span class="ot">NA</span>        <span class="ot">NA</span></code></pre></div>
</div>
<div id="step-6-adjusting-for-invalid-hiv-testing-coverage" class="section level2">
<h2 class="hasAnchor">
<a href="#step-6-adjusting-for-invalid-hiv-testing-coverage" class="anchor"></a>Step 6 ) Adjusting for invalid HIV testing coverage</h2>
<p>If data quality indicators have indicated that some values are invalid, it is warranted to adjust them. Specifically, it is possible that testing coverage is higher than 100% if, following a first HIV negative test, subsequent tests at ANC visits are included (i.e., multiple testing). The <code><a href="reference/mt_adjust.html">mt_adjust()</a></code> function can be used to adjust for this. There are three 4 different adjustment options that can be implemented if HIV testing coverage is &gt;100%:</p>
<ul>
<li>
<code>impute</code>: replace <code>n_status_c</code> with the facility’s mean testing coverage (only including valid coverage observations to calculate the mean) multiplied by <code>n_clients</code>.</li>
<li>
<code>remove</code>: replace <code>n_status_c</code> wih a missing value (<code>NA</code>).</li>
<li>
<code>setmax</code>: replace <code>n_status_c</code> with <code>n_clients</code>.</li>
<li>
<code>none</code>: no adjustment is made.</li>
</ul>
<p>The specific adjustment to be chosen depends on the hypothesized mechanism that generated these data inconsistencies. It is recommend to explore the impact of these different adjustment options using the graphical function detaield bleow. Consult the help file for more information by typing <code><a href="https://rdrr.io/r/utils/help.html">help(mt_adjust)</a></code> in your console.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ancrt_cleaned &lt;-<span class="st"> </span><span class="kw"><a href="reference/mt_adjust.html">mt_adjust</a></span>(ancrt_cleaned, <span class="dt">adjust_option =</span> <span class="st">"setmax"</span>)</code></pre></div>
</div>
<div id="step-7-calculating-hiv-prevalence-and-hiv-testing-coverage-with-and-without-adjustment-for-missing-reporting-period" class="section level2">
<h2 class="hasAnchor">
<a href="#step-7-calculating-hiv-prevalence-and-hiv-testing-coverage-with-and-without-adjustment-for-missing-reporting-period" class="anchor"></a>Step 7) Calculating HIV prevalence and HIV testing coverage (with and without adjustment for missing reporting period)</h2>
<p>After data cleaning and adjustments, one could calculate HIV prevalence and testing coverage. The function <code><a href="reference/hiv_prv_cov.html">hiv_prv_cov()</a></code> will calculate the raw HIV prevalence, the HIV prevalence adjusted for previous adjustments, and the HIV testing coverage. Note that these estimates are not adjusted for missing reporting periods or imperfect HIV testing coverage. Results can be calculated stratified by the subnational units (<code>snu1</code>), the reporting period or the year according to user inputs. See <code><a href="https://rdrr.io/r/utils/help.html">help(hiv_prv_cov)</a></code> for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="reference/hiv_prv_cov.html">hiv_prv_cov</a></span>(ancrt_cleaned, <span class="dt">by_period =</span> <span class="ot">FALSE</span>, <span class="dt">by_snu1 =</span> <span class="ot">FALSE</span>, <span class="dt">by_year =</span> <span class="ot">FALSE</span>)
  snu1 hiv_raw hiv_prv hiv_cov
<span class="dv">1</span>  All  <span class="fl">17.07</span>   <span class="fl">17.11</span>  <span class="fl">95.55</span></code></pre></div>
<p>Alternatively, if some facilities did not report data at certain time periods, the function <code><a href="reference/hiv_prv_ipcw.html">hiv_prv_ipcw()</a></code> can be used to adjust the HIV prevalence and HIV testing coverage for missing reporting periods (thereby reducing the possibility of selection bias) using inverse probability of censoring weighting (IPCW). Results can be calculated stratified by the subnational units, the reporting period or the year according to user inputs (see <code><a href="https://rdrr.io/r/utils/help.html">help(hiv_prv_ipcw)</a></code> for more information). Specifically, the IPCW is calculated as follow:</p>
<p>\begin{align} \ w &amp; = &amp; \frac{1}{P(\text{Not being censored } | \text{ facility})} \ \end{align}</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="reference/hiv_prv_ipcw.html">hiv_prv_ipcw</a></span>(ancrt_cleaned)
  snu1 hiv_raw hiv_prv hiv_cov
<span class="dv">1</span>  all  <span class="fl">17.07</span>   <span class="fl">17.11</span>  <span class="fl">95.55</span></code></pre></div>
</div>
<div id="step-8-adjusting-hiv-prevalence-for-imperfect-testing-coverage" class="section level2">
<h2 class="hasAnchor">
<a href="#step-8-adjusting-hiv-prevalence-for-imperfect-testing-coverage" class="anchor"></a>Step 8) Adjusting HIV prevalence for imperfect testing coverage</h2>
<p>It has been found that selection bias can be introduced into HIV prevalence estimates due to imperfect HIV testing coverage (i.e. &lt; 100% coverage). If the average testing coverage is low (i.e., &lt;90%), it can be advised to adjust for these potential biases.</p>
<p>Using data from the <em>President Emergency Funds for AIDS Relief in Africa</em>’s (PEPFAR) <em>Monitoring, Evaluation, and Reporting</em> (MER) database, we estimated adjustment factors for each 1% point increase in HIV testing coverage. To do so, we used binomial logistic regression models with facility-level fixed effects and marginal standardization to assess the effect of testing coverage on HIV prevalence (see Maheu-Giroux et al. (2019) for details on the methods, applied to Malawi’s ANC-RT data). The PEPFAR MER database contains information on more than 37 millions ANC attendees from 19,527 unique facilities from 17 countries in sub-Saharan Africa, totaling 226,541 observations over the 2015-2019 period. The figure below shows the estimated relationship between imperfect testing coverage and HIV preavlence (Fig 2)</p>
<p><img src="reference/figures/PEPFAR_MER.png" alt="Fig. 2. Relationship between routine HIV testing coverage during antenatal care and predicted HIV prevalence. The dots on the graph are a subset of monthly observations of HIV prevalence at antenatal care. The size of the dots is proportional to the number of women attending antenatal care."></p>
<p>The <code><a href="reference/impcov_adjust.html">impcov_adjust()</a></code> function can be used to implement this adjustment, after having used the the <code><a href="reference/data_clean.html">data_clean()</a></code>, <code><a href="reference/mt_adjust.html">mt_adjust()</a></code> functions. The <code><a href="reference/impcov_adjust.html">impcov_adjust()</a></code> function must be used on a data frame from either the <code><a href="reference/hiv_prv_cov.html">hiv_prv_cov()</a></code> function - for estimates adjusted for missing reporting periods - or the <code><a href="reference/hiv_prv_ipcw.html">hiv_prv_ipcw()</a></code> function - for estimates adjusted for missing reporting periods. If results were reported stratified by the first subnational unit (<code>snu1</code>), the reporting period (<code>by_period = TRUE)</code> and/or the year (<code>by_year = TRUE</code>) in <code><a href="reference/hiv_prv_cov.html">hiv_prv_cov()</a></code> or <code><a href="reference/hiv_prv_ipcw.html">hiv_prv_ipcw()</a></code>, the adjustment for imperfect testing coverage will also be strafied by the same variable(s). See <code><a href="https://rdrr.io/r/utils/help.html">help(impcov_adjust)</a></code> for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>prv_cov &lt;-<span class="st"> </span><span class="kw"><a href="reference/hiv_prv_cov.html">hiv_prv_cov</a></span>(ancrt_cleaned, <span class="dt">by_snu1 =</span> <span class="ot">TRUE</span>, <span class="dt">by_period =</span> <span class="ot">FALSE</span>, <span class="dt">by_year =</span> <span class="ot">FALSE</span>)
<span class="op">&gt;</span><span class="st"> </span>results &lt;-<span class="st"> </span><span class="kw"><a href="reference/impcov_adjust.html">impcov_adjust</a></span>(<span class="dt">data =</span> prv_cov)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>results
snu1 hiv_raw hiv_prv hiv_cov adjusted_prv
<span class="dv">1</span>    <span class="dv">1</span>  <span class="fl">15.89</span>   <span class="fl">15.93</span>  <span class="fl">95.74</span>         <span class="fl">15.84</span>
<span class="dv">2</span>    <span class="dv">2</span>  <span class="fl">17.44</span>   <span class="fl">17.48</span>  <span class="fl">95.52</span>         <span class="fl">17.38</span>
<span class="dv">3</span>    <span class="dv">3</span>  <span class="fl">18.14</span>   <span class="fl">18.17</span>  <span class="fl">95.33</span>         <span class="fl">18.05</span></code></pre></div>
<p>Alternatively, if users want to examine the impact of this adjustment on selected observed HIV prevalence estimates at imperfect testing coverage, the same function can be use. To do so, imply enter the point estimate for HIV prevalence and HIV testing coverage and the adjusted prevalence will be outputed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="reference/impcov_adjust.html">impcov_adjust</a></span>(<span class="dt">hiv_prv_point =</span> <span class="dv">25</span>, <span class="dt">hiv_cov_point =</span> <span class="dv">75</span>)
[<span class="dv">1</span>] <span class="fl">23.59513</span></code></pre></div>
</div>
<div id="step-9-plotting-raw-and-adjusted-hiv-prevalence-over-time" class="section level2">
<h2 class="hasAnchor">
<a href="#step-9-plotting-raw-and-adjusted-hiv-prevalence-over-time" class="anchor"></a>Step 9) Plotting raw and adjusted HIV prevalence over time</h2>
<p>The final step is to examine the impact (if any) of the data cleaning and adjustments. Specifically, it can be useful to compare the raw HIV prevalence to the fully adjusted HIV prevalence (following data cleaning, adjustment for multiple testing, adjustment for missing reporting periods and adjustment for imperfect HIV testing coverage). The easiest way to compare these is by plotting the raw and fully adjusted HIV prevalence over time. The function <code><a href="reference/plot_rawadjusted.html">plot_rawadjusted()</a></code> will perform this task. This function requires that you input the dataframe output by <code><a href="reference/impcov_adjust.html">impcov_adjust()</a></code> and that the results be stratifed by reporting period or year. Therefore, <code>by_period = TRUE</code> or <code>by_year = TRUE</code> must be specified in the <code><a href="reference/hiv_prv_cov.html">hiv_prv_cov()</a></code> or <code><a href="reference/hiv_prv_ipcw.html">hiv_prv_ipcw()</a></code> function, prior to running the <code><a href="reference/impcov_adjust.html">impcov_adjust()</a></code> function. See <code><a href="https://rdrr.io/r/utils/help.html">help(plot_rawadjusted)</a></code> for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>prv_cov &lt;-<span class="st"> </span><span class="kw"><a href="reference/hiv_prv_ipcw.html">hiv_prv_ipcw</a></span>(ancrt_cleaned, <span class="dt">by_snu1 =</span> <span class="ot">FALSE</span>, <span class="dt">by_period =</span> <span class="ot">TRUE</span>, <span class="dt">by_year =</span> <span class="ot">FALSE</span>)
<span class="op">&gt;</span><span class="st"> </span>results &lt;-<span class="st"> </span><span class="kw"><a href="reference/impcov_adjust.html">impcov_adjust</a></span>(prv_cov)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="reference/plot_rawadjusted.html">plot_rawadjusted</a></span>(results, <span class="dt">snu1 =</span> <span class="st">"all"</span>, <span class="dt">time_unit =</span> <span class="st">"period"</span>, <span class="dt">hiv_raw =</span> <span class="ot">TRUE</span>, <span class="dt">y_lim =</span> <span class="dv">40</span>)</code></pre></div>
<p><img src="reference/figures/README-example-2.png" alt="Fig 3. Plot of the raw and adjusted HIV prevalence over time."></p>
</div>
<div id="community-guidelines" class="section level2">
<h2 class="hasAnchor">
<a href="#community-guidelines" class="anchor"></a>Community Guidelines</h2>
<p>Contributions to the software are welcome and can be made as pull requests to the branch master. Issues or problems with the software can be reported and support can be obtained in the project’s Github page or by e-mailing <a href="mailto:brittany.blouin@mail.mcgill.ca">brittany.blouin@mail.mcgill.ca</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/brittanyblouin/ANCRTAdjust">https://​github.com/​brittanyblouin/​ANCRTAdjust</a>
</li>
<li>Report a bug at <br><a href="https://github.com/brittanyblouin/ANCRTAdjust/issues">https://​github.com/​brittanyblouin/​ANCRTAdjust/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mathieu Maheu-Giroux <br><small class="roles"> Author, maintainer </small>  </li>
<li>Brittany Blouin <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Mathieu Maheu-Giroux, Brittany Blouin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
